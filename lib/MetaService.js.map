{"version":3,"sources":["../src/MetaService.js"],"names":[],"mappings":"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","file":"MetaService.js","sourcesContent":["import {Service, Inject} from 'fd-angular-core';\n\n@Service('Meta')\n@Inject('$rootScope', '$location')\nclass MetaService {\n\n  constructor($rootScope, $location) {\n    this.$rootScope = $rootScope;\n    this.$location  = $location;\n\n    this.stack = [];\n    this.top = null;\n\n    this.push({});\n  }\n\n  push(data) {\n    let top = this.top;\n    let loc = this.$location;\n\n    if (!data.url) {\n      data.url = loc.absUrl();\n    }\n\n    if (top) {\n      if (!data.siteName) {\n        data.siteName = top.siteName;\n      }\n\n      if (!data.title) {\n        data.title = top.title;\n      }\n\n      if (!data.image) {\n        data.image = top.image;\n      }\n\n      if (!data.description) {\n        data.description = top.description;\n      }\n\n      if (!data.type) {\n        data.type = top.type;\n      }\n\n      if (!data.twitterHandle) {\n        data.twitterHandle = top.twitterHandle;\n      }\n\n      if (!data.status) {\n        data.status = top.status;\n      }\n    }\n\n    if (!data.type) {\n      data.type = 'website';\n    }\n\n    if (!data.status) {\n      data.status = 200;\n    }\n\n    data.image = toAbsUrl(data.image);\n\n    data.url = toAbsUrl(data.url);\n\n    this.stack.push(data);\n    this.top = data;\n    this.$rootScope.meta = this.top;\n  }\n\n  pop(data) {\n    this.stack.pop();\n    this.top = this.stack[this.stack.length-1];\n    this.$rootScope.meta = this.top;\n  }\n\n}\n\nfunction toAbsUrl(url) {\n    if ( !url ) {\n        return null;\n    }\n\n    if (url.indexOf('http') === 0) {\n        return url;\n    }\n\n    if (url.indexOf('//') === 0) {\n      return `${window.location.protocol}:${url}`;\n    }\n\n    if (url.indexOf('/') === 0) {\n      return `${window.location.protocol}://${window.location.host}${url}`;\n    }\n\n    return `${window.location.protocol}://${window.location.host}/${url}`;\n}\n"]}